"use strict";(self.webpackChunkselectdb_portal=self.webpackChunkselectdb_portal||[]).push([[91849],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>f});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var i=r.createContext({}),s=function(e){var t=r.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},c=function(e){var t=s(e.components);return r.createElement(i.Provider,{value:t},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,i=e.parentName,c=u(e,["components","mdxType","originalType","parentName"]),p=s(n),d=a,f=p["".concat(i,".").concat(d)]||p[d]||m[d]||o;return n?r.createElement(f,l(l({ref:t},c),{},{components:n})):r.createElement(f,l({ref:t},c))}));function f(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,l=new Array(o);l[0]=d;var u={};for(var i in t)hasOwnProperty.call(t,i)&&(u[i]=t[i]);u.originalType=e,u[p]="string"==typeof e?e:a,l[1]=u;for(var s=2;s<o;s++)l[s]=n[s];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},11499:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>u,toc:()=>s});var r=n(87462),a=(n(67294),n(3905));const o={title:"TOPN",language:"zh-CN"},l=void 0,u={unversionedId:"sql-manual/sql-functions/aggregate-functions/histogram",id:"version-dev/sql-manual/sql-functions/aggregate-functions/histogram",title:"TOPN",description:"\x3c!--",source:"@site/versioned_docs/version-dev/sql-manual/sql-functions/aggregate-functions/histogram.md",sourceDirName:"sql-manual/sql-functions/aggregate-functions",slug:"/sql-manual/sql-functions/aggregate-functions/histogram",permalink:"/docs/dev/sql-manual/sql-functions/aggregate-functions/histogram",draft:!1,editUrl:"https://github.com/apache/doris/edit/master/docs/en/docs/sql-manual/sql-functions/aggregate-functions/histogram.md",tags:[],version:"dev",frontMatter:{title:"TOPN",language:"zh-CN"}},i={},s=[{value:"HISTOGRAM",id:"histogram",level:2},{value:"description",id:"description",level:3},{value:"Syntax",id:"syntax",level:4},{value:"notice",id:"notice",level:3},{value:"example",id:"example",level:3},{value:"keywords",id:"keywords",level:3}],c={toc:s};function p(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"histogram"},"HISTOGRAM"),(0,a.kt)("h3",{id:"description"},"description"),(0,a.kt)("h4",{id:"syntax"},"Syntax"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"histogram(expr[, DOUBLE sample_rate, INT max_bucket_num])")),(0,a.kt)("p",null,'The histogram function is used to describe the distribution of the data. It uses an "equal height" bucking strategy, and divides the data into buckets according to the value of the data. It describes each bucket with some simple data, such as the number of values that fall in the bucket. It is mainly used by the optimizer to estimate the range query.'),(0,a.kt)("p",null,"The result of the function returns an empty or Json string."),(0,a.kt)("p",null,"Parameter description\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"sample_rate\uff1aOptional. The proportion of sample data used to generate the histogram. The default is 0.2."),(0,a.kt)("li",{parentName:"ul"},"max_bucket_num\uff1aOptional. Limit the number of histogram buckets. The default value is 128.")),(0,a.kt)("p",null,"Alias function: ",(0,a.kt)("inlineCode",{parentName:"p"},"hist(expr[, DOUBLE sample_rate, INT max_bucket_num])")),(0,a.kt)("h3",{id:"notice"},"notice"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Only supported in vectorized engine")),(0,a.kt)("h3",{id:"example"},"example"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'MySQL [test]> SELECT histogram(c_float) FROM histogram_test;\n+-------------------------------------------------------------------------------------------------------------------------------------+\n| histogram(`c_float`)                                                                                                                |\n+-------------------------------------------------------------------------------------------------------------------------------------+\n| {"sample_rate":0.2,"max_bucket_num":128,"bucket_num":3,"buckets":[{"lower":"0.1","upper":"0.1","count":1,"pre_sum":0,"ndv":1},...]} |\n+-------------------------------------------------------------------------------------------------------------------------------------+\n\nMySQL [test]> SELECT histogram(c_string, 0.5, 2) FROM histogram_test;\n+-------------------------------------------------------------------------------------------------------------------------------------+\n| histogram(`c_string`)                                                                                                               |\n+-------------------------------------------------------------------------------------------------------------------------------------+\n| {"sample_rate":0.5,"max_bucket_num":2,"bucket_num":2,"buckets":[{"lower":"str1","upper":"str7","count":4,"pre_sum":0,"ndv":3},...]} |\n+-------------------------------------------------------------------------------------------------------------------------------------+\n')),(0,a.kt)("p",null,"Query result description\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'{\n    "sample_rate": 0.2, \n    "max_bucket_num": 128, \n    "bucket_num": 3, \n    "buckets": [\n        {\n            "lower": "0.1", \n            "upper": "0.2", \n            "count": 2, \n            "pre_sum": 0, \n            "ndv": 2\n        }, \n        {\n            "lower": "0.8", \n            "upper": "0.9", \n            "count": 2, \n            "pre_sum": 2, \n            "ndv": 2\n        }, \n        {\n            "lower": "1.0", \n            "upper": "1.0", \n            "count": 2, \n            "pre_sum": 4, \n            "ndv": 1\n        }\n    ]\n}\n')),(0,a.kt)("p",null,"Field description\uff1a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"sample_rate\uff1aRate of sampling"),(0,a.kt)("li",{parentName:"ul"},"max_bucket_num\uff1aLimit the maximum number of buckets"),(0,a.kt)("li",{parentName:"ul"},"bucket_num\uff1aThe actual number of buckets"),(0,a.kt)("li",{parentName:"ul"},"buckets\uff1aAll buckets",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"lower\uff1aUpper bound of the bucket"),(0,a.kt)("li",{parentName:"ul"},"upper\uff1aLower bound of the bucket"),(0,a.kt)("li",{parentName:"ul"},"count\uff1aThe number of elements contained in the bucket"),(0,a.kt)("li",{parentName:"ul"},"pre_sum\uff1aThe total number of elements in the front bucket"),(0,a.kt)("li",{parentName:"ul"},"ndv\uff1aThe number of different values in the bucket")))),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Total number of histogram elements = number of elements in the last bucket(count) + total number of elements in the previous bucket(pre_sum).")),(0,a.kt)("h3",{id:"keywords"},"keywords"),(0,a.kt)("p",null,"HISTOGRAM, HIST"))}p.isMDXComponent=!0}}]);